gbrename() {
  local file bname

  file=$(mktemp)

  git symbolic-ref --short HEAD > "$file"
  echo -e "\n\n" >> "$file"
  echo "# Empty line 1 to cancel" >> "$file"
  "${EDITOR:-vim}" "$file" -c ":set ft=sh"

  bname=$(head -n 1 "$file")
  if [[ "$bname" == '' ]]; then
    return 1
  else
    git branch -m "$bname"
  fi

  rm "$file"

  return 0
}
